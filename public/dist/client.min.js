"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var GameEngine=function(){function i(e,t,n){_classCallCheck(this,i),this.scene=e,this.renderer=t,this.camera=n}return _createClass(i,[{key:"run",value:function(){this.runGameLoop()}},{key:"runGameLoop",value:function(){var e=this;this.updateGame(),this.updatePhysics(),this.render(),requestAnimationFrame(function(){return e.runGameLoop()})}},{key:"updateGame",value:function(){this.scene.update()}},{key:"updatePhysics",value:function(){}},{key:"render",value:function(){this.renderer.render(this.scene.scene,this.camera)}}]),i}(),Scene=function(){function n(e,t){_classCallCheck(this,n),this.width=e,this.height=t,this.gameObjects=[],this.createScene()}return _createClass(n,[{key:"createScene",value:function(){this.scene=new THREE.Scene}},{key:"addSkyBox",value:function(e){this.scene.background=e.cubeTexture}},{key:"addLight",value:function(e){this.scene.add(e)}},{key:"addGameObject",value:function(e){this.scene.add(e.model),this.gameObjects.push(e)}},{key:"update",value:function(){this.gameObjects.forEach(function(e){e.update()})}}]),n}(),Renderer=function(){function n(e,t){_classCallCheck(this,n),this.createRenderer(),this.setupSize(e,t),this.enableShadowMap(),this.addToDocument()}return _createClass(n,[{key:"setupSize",value:function(e,t){this.renderer.setSize(e,t)}},{key:"enableShadowMap",value:function(){this.renderer.shadowMap.enabled=!0}},{key:"createRenderer",value:function(){this.renderer=new THREE.WebGLRenderer({antialias:!0})}},{key:"addToDocument",value:function(){document.body.appendChild(this.renderer.domElement)}},{key:"setupToneMappingWithExposure",value:function(e){this.renderer.toneMapping=THREE.ReinhardToneMapping,this.renderer.toneMappingExposure=e}},{key:"render",value:function(e,t){this.renderer.render(e,t)}}]),n}(),Skybox=function e(t,n){_classCallCheck(this,e),this.cubeTexture=(new THREE.CubeTextureLoader).setPath(t).load(n)},GameObject=function(){function t(e){_classCallCheck(this,t),this.model=e}return _createClass(t,[{key:"update",value:function(){}}]),t}(),Car=function(){function n(e){var t;return _classCallCheck(this,n),(t=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this,e))).speed=1,t.direction={x:0,y:0,z:0},t.angle={z:0},t}return _inherits(n,GameObject),_createClass(n,[{key:"update",value:function(){this.model.translateOnAxis(this.direction,this.speed),this.model.rotation.z=this.angle.z}}]),n}(),windowsWidth=window.innerWidth,windowsHeight=window.innerHeight;function addSkyBoxToScene(e){var t=new Skybox("images/skybox1/greenery/",["meadow_ft.jpg","meadow_bk.jpg","meadow_up.jpg","meadow_dn.jpg","meadow_rt.jpg","meadow_lf.jpg"]);e.addSkyBox(t)}function addHemiLight(e){var t=new THREE.HemisphereLight(16777011,5986109,2.5);e.addLight(t)}function addSpotLight(e){var t=new THREE.SpotLight(16777215,3);t.castShadow=!0,t.shadow.bias=-1e-4,t.shadow.mapSize.width=4096,t.shadow.mapSize.height=4096,e.addLight(t)}function addLightToScene(e){addHemiLight(e),addSpotLight(e)}function createCamera(){var e=windowsWidth/windowsHeight,t=new THREE.PerspectiveCamera(90,e,.1,4e4);return t.position.set(4,4,20),t}function setupCameraControl(e,t){new THREE.OrbitControls(e,t.renderer.domElement).update()}function addModelToScene(i){(new THREE.GLTFLoader).load("models/house/scene.gltf",function(e){var t=e.scene.children[0];t.position.set(0,0,0),t.traverse(function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material.map&&(e.material.map.anisotropy=16))});var n=new Car(t);new CarInputController(n);i.addGameObject(n)})}function createRenderer(){var e=new Renderer(windowsWidth,windowsHeight);return e.setupToneMappingWithExposure(2),e}function createScene(){var e=new Scene(windowsWidth,windowsHeight);return addLightToScene(e),addSkyBoxToScene(e),addModelToScene(e),e}var CarInputController=function(){function t(e){var n=this;_classCallCheck(this,t),this.mouseSensitivity=200,this.car=e;new KeyboardInputHandler(function(e,t){return n.listenKeyEvent(e,t)}),new MouseInputHandler(function(e,t){return n.listenMouseMovement(e,t)})}return _createClass(t,[{key:"listenMouseMovement",value:function(e){this.car.angle.z+=e/this.mouseSensitivity}},{key:"moveLeft",value:function(e){e==KeyState.DOWN?this.car.direction.x=-1:-1==this.car.direction.x&&(this.car.direction.x=0)}},{key:"moveRight",value:function(e){e==KeyState.DOWN?this.car.direction.x=1:1==this.car.direction.x&&(this.car.direction.x=0)}},{key:"moveDown",value:function(e){e==KeyState.DOWN?this.car.direction.y=1:1==this.car.direction.y&&(this.car.direction.y=0)}},{key:"moveUp",value:function(e){e==KeyState.DOWN?this.car.direction.y=-1:-1==this.car.direction.y&&(this.car.direction.y=0)}},{key:"listenKeyEvent",value:function(e,t){e==Keys.LEFT&&this.moveLeft(t),e==Keys.DOWN&&this.moveDown(t),e==Keys.RIGHT&&this.moveRight(t),e==Keys.UP&&this.moveUp(t)}}]),t}(),MouseInputHandler=function(){function t(e){_classCallCheck(this,t),this.listener=e,this.setupMouseMoveListener(),this.lockPointer()}return _createClass(t,[{key:"setupMouseMoveListener",value:function(){var t=this;document.onmousemove=function(e){t.listener(e.movementX,e.movementY)}}},{key:"lockPointer",value:function(){document.onmousedown=function(){document.body.requestPointerLock()}}}]),t}(),KeyboardInputHandler=function(){function t(e){_classCallCheck(this,t),this.listner=e,this.setupKeyUpListener(),this.setupKeyDownListener()}return _createClass(t,[{key:"setupKeyUpListener",value:function(){var t=this;document.onkeyup=function(e){t.listner(e.key,KeyState.UP)}}},{key:"setupKeyDownListener",value:function(){var t=this;document.onkeydown=function(e){t.listner(e.key,KeyState.DOWN)}}}]),t}();function main(){var e=createRenderer(),t=createScene(),n=createCamera();setupCameraControl(n,e),new GameEngine(t,e,n).run()}main();
//# sourceMappingURL=client.min.js.map
