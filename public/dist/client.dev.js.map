{"version":3,"sources":["client.js"],"names":["GameEngine","scene","renderer","camera","runGameLoop","updateGame","updatePhysics","render","requestAnimationFrame","update","Scene","width","height","gameObjects","createScene","THREE","skybox","background","cubeTexture","light","add","gameObject","model","push","forEach","Renderer","createRenderer","setupSize","enableShadowMap","addToDocument","setSize","shadowMap","enabled","WebGLRenderer","antialias","document","body","appendChild","domElement","exposure","toneMapping","ReinhardToneMapping","toneMappingExposure","Skybox","path","images","CubeTextureLoader","setPath","load","GameObject","Car","speed","direction","x","y","z","angle","translateOnAxis","rotation","windowsWidth","window","innerWidth","windowsHeight","innerHeight","addSkyBoxToScene","addSkyBox","addHemiLight","hemiLight","HemisphereLight","addLight","addSpotLight","spotLight1","SpotLight","castShadow","shadow","bias","mapSize","addLightToScene","createCamera","aspect","PerspectiveCamera","position","set","setupCameraControl","control","OrbitControls","addModelToScene","GLTFLoader","result","children","traverse","object1","isMesh","receiveShadow","material","map","anisotropy","car","controller","CarInputController","addGameObject","setupToneMappingWithExposure","mouseSensitivity","k","KeyboardInputHandler","key","state","listenKeyEvent","m","MouseInputHandler","listenMouseMovement","KeyState","DOWN","Keys","LEFT","moveLeft","moveDown","RIGHT","moveRight","UP","moveUp","listener","setupMouseMoveListener","lockPointer","self","onmousemove","mouseEvent","movementX","movementY","onmousedown","requestPointerLock","listner","setupKeyUpListener","setupKeyDownListener","onkeyup","keyEvent","onkeydown","main","engine","run"],"mappings":";;;;;;;;;;;;;;;;;;;;IAAMA,U;;;AACJ,sBAAYC,KAAZ,EAAmBC,QAAnB,EAA6BC,MAA7B,EAAqC;AAAA;;AACnC,SAAKF,KAAL,GAAaA,KAAb;AACA,SAAKC,QAAL,GAAgBA,QAAhB;AACA,SAAKC,MAAL,GAAcA,MAAd;AACD;;;;0BAEK;AACJ,WAAKC,WAAL;AACD;;;kCAEa;AAAA;;AACZ,WAAKC,UAAL;AACA,WAAKC,aAAL;AACA,WAAKC,MAAL;AACAC,MAAAA,qBAAqB,CAAC;AAAA,eAAM,KAAI,CAACJ,WAAL,EAAN;AAAA,OAAD,CAArB;AACD;;;iCAEY;AACX,WAAKH,KAAL,CAAWQ,MAAX;AACD;;;oCAEe,CAAE;;;6BAET;AACP,WAAKP,QAAL,CAAcK,MAAd,CAAqB,KAAKN,KAAL,CAAWA,KAAhC,EAAuC,KAAKE,MAA5C;AACD;;;;;;IAGGO,K;;;AACJ,iBAAYC,KAAZ,EAAmBC,MAAnB,EAA2B;AAAA;;AACzB,SAAKD,KAAL,GAAaA,KAAb;AACA,SAAKC,MAAL,GAAcA,MAAd;AACA,SAAKC,WAAL,GAAmB,EAAnB;AACA,SAAKC,WAAL;AACD;;;;kCAEa;AACZ,WAAKb,KAAL,GAAa,IAAIc,KAAK,CAACL,KAAV,EAAb;AACD;;;8BAESM,M,EAAQ;AAChB,WAAKf,KAAL,CAAWgB,UAAX,GAAwBD,MAAM,CAACE,WAA/B;AACD;;;6BAEQC,K,EAAO;AACd,WAAKlB,KAAL,CAAWmB,GAAX,CAAeD,KAAf;AACD;;;kCAEaE,U,EAAY;AACxB,WAAKpB,KAAL,CAAWmB,GAAX,CAAeC,UAAU,CAACC,KAA1B;AACA,WAAKT,WAAL,CAAiBU,IAAjB,CAAsBF,UAAtB;AACD;;;6BAEQ;AACP,WAAKR,WAAL,CAAiBW,OAAjB,CAAyB,UAACH,UAAD,EAAgB;AACvCA,QAAAA,UAAU,CAACZ,MAAX;AACD,OAFD;AAGD;;;;;;IAGGgB,Q;;;AACJ,oBAAYd,KAAZ,EAAmBC,MAAnB,EAA2B;AAAA;;AACzB,SAAKc,cAAL;AACA,SAAKC,SAAL,CAAehB,KAAf,EAAsBC,MAAtB;AACA,SAAKgB,eAAL;AACA,SAAKC,aAAL;AACD;;;;8BAESlB,K,EAAOC,M,EAAQ;AACvB,WAAKV,QAAL,CAAc4B,OAAd,CAAsBnB,KAAtB,EAA6BC,MAA7B;AACD;;;sCAEiB;AAChB,WAAKV,QAAL,CAAc6B,SAAd,CAAwBC,OAAxB,GAAkC,IAAlC;AACD;;;qCAEgB;AACf,WAAK9B,QAAL,GAAgB,IAAIa,KAAK,CAACkB,aAAV,CAAwB;AAAEC,QAAAA,SAAS,EAAE;AAAb,OAAxB,CAAhB;AACD;;;oCAEe;AACdC,MAAAA,QAAQ,CAACC,IAAT,CAAcC,WAAd,CAA0B,KAAKnC,QAAL,CAAcoC,UAAxC;AACD;;;iDAE4BC,Q,EAAU;AACrC,WAAKrC,QAAL,CAAcsC,WAAd,GAA4BzB,KAAK,CAAC0B,mBAAlC;AACA,WAAKvC,QAAL,CAAcwC,mBAAd,GAAoCH,QAApC;AACD;;;2BAEMtC,K,EAAOE,M,EAAQ;AACpB,WAAKD,QAAL,CAAcK,MAAd,CAAqBN,KAArB,EAA4BE,MAA5B;AACD;;;;;;IAGGwC,M,GACJ,gBAAYC,IAAZ,EAAkBC,MAAlB,EAA0B;AAAA;;AACxB,OAAK3B,WAAL,GAAmB,IAAIH,KAAK,CAAC+B,iBAAV,GAA8BC,OAA9B,CAAsCH,IAAtC,EAA4CI,IAA5C,CAAiDH,MAAjD,CAAnB;AACD,C;;IAGGI,U;;;AACJ,sBAAY3B,KAAZ,EAAmB;AAAA;;AACjB,SAAKA,KAAL,GAAaA,KAAb;AACD;;;;6BAEQ,CAAE;;;;;;IAGP4B,G;;;;;AACJ,eAAY5B,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8EAAMA,KAAN;AACA,WAAK6B,KAAL,GAAa,CAAb;AACA,WAAKC,SAAL,GAAiB;AAAEC,MAAAA,CAAC,EAAE,CAAL;AAAQC,MAAAA,CAAC,EAAE,CAAX;AAAcC,MAAAA,CAAC,EAAE;AAAjB,KAAjB;AACA,WAAKC,KAAL,GAAa;AAAED,MAAAA,CAAC,EAAE;AAAL,KAAb;AAJiB;AAKlB;;;;6BAEQ;AACP,WAAKjC,KAAL,CAAWmC,eAAX,CAA2B,KAAKL,SAAhC,EAA2C,KAAKD,KAAhD;AACA,WAAK7B,KAAL,CAAWoC,QAAX,CAAoBH,CAApB,GAAwB,KAAKC,KAAL,CAAWD,CAAnC;AACD;;;;EAXeN,U;;AAclB,IAAMU,YAAY,GAAGC,MAAM,CAACC,UAA5B;AACA,IAAMC,aAAa,GAAGF,MAAM,CAACG,WAA7B;;AAEA,SAASC,gBAAT,CAA0B/D,KAA1B,EAAiC;AAC/B,MAAI2C,IAAI,GAAG,0BAAX;AACA,MAAIC,MAAM,GAAG,CACX,eADW,EAEX,eAFW,EAGX,eAHW,EAIX,eAJW,EAKX,eALW,EAMX,eANW,CAAb;AAQA,MAAI7B,MAAM,GAAG,IAAI2B,MAAJ,CAAWC,IAAX,EAAiBC,MAAjB,CAAb;AACA5C,EAAAA,KAAK,CAACgE,SAAN,CAAgBjD,MAAhB;AACD;;AAED,SAASkD,YAAT,CAAsBjE,KAAtB,EAA6B;AAC3B,MAAMkE,SAAS,GAAG,IAAIpD,KAAK,CAACqD,eAAV,CAA0B,QAA1B,EAAoC,QAApC,EAA8C,GAA9C,CAAlB;AACAnE,EAAAA,KAAK,CAACoE,QAAN,CAAeF,SAAf;AACD;;AAED,SAASG,YAAT,CAAsBrE,KAAtB,EAA6B;AAC3B,MAAMsE,UAAU,GAAG,IAAIxD,KAAK,CAACyD,SAAV,CAAoB,QAApB,EAA8B,CAA9B,CAAnB;AACAD,EAAAA,UAAU,CAACE,UAAX,GAAwB,IAAxB;AACAF,EAAAA,UAAU,CAACG,MAAX,CAAkBC,IAAlB,GAAyB,CAAC,MAA1B;AACAJ,EAAAA,UAAU,CAACG,MAAX,CAAkBE,OAAlB,CAA0BjE,KAA1B,GAAkC,IAAlC;AACA4D,EAAAA,UAAU,CAACG,MAAX,CAAkBE,OAAlB,CAA0BhE,MAA1B,GAAmC,IAAnC;AACAX,EAAAA,KAAK,CAACoE,QAAN,CAAeE,UAAf;AACD;;AAED,SAASM,eAAT,CAAyB5E,KAAzB,EAAgC;AAC9BiE,EAAAA,YAAY,CAACjE,KAAD,CAAZ;AACAqE,EAAAA,YAAY,CAACrE,KAAD,CAAZ;AACD;;AAED,SAAS6E,YAAT,GAAwB;AACtB,MAAMC,MAAM,GAAGpB,YAAY,GAAGG,aAA9B;AACA,MAAI3D,MAAM,GAAG,IAAIY,KAAK,CAACiE,iBAAV,CAA4B,EAA5B,EAAgCD,MAAhC,EAAwC,GAAxC,EAA6C,KAA7C,CAAb;AACA5E,EAAAA,MAAM,CAAC8E,QAAP,CAAgBC,GAAhB,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,EAA1B;AAEA,SAAO/E,MAAP;AACD;;AAED,SAASgF,kBAAT,CAA4BhF,MAA5B,EAAoCD,QAApC,EAA8C;AAC5C,MAAIkF,OAAO,GAAG,IAAIrE,KAAK,CAACsE,aAAV,CAAwBlF,MAAxB,EAAgCD,QAAQ,CAACA,QAAT,CAAkBoC,UAAlD,CAAd;AACA8C,EAAAA,OAAO,CAAC3E,MAAR;AACD;;AAED,SAAS6E,eAAT,CAAyBrF,KAAzB,EAAgC;AAC9B,MAAIc,KAAK,CAACwE,UAAV,GAAuBvC,IAAvB,CAA4B,yBAA5B,EAAuD,UAACwC,MAAD,EAAY;AACjE,QAAIlE,KAAK,GAAGkE,MAAM,CAACvF,KAAP,CAAawF,QAAb,CAAsB,CAAtB,CAAZ;AACAnE,IAAAA,KAAK,CAAC2D,QAAN,CAAeC,GAAf,CAAmB,GAAnB,EAAwB,GAAxB,EAA6B,GAA7B;AACA5D,IAAAA,KAAK,CAACoE,QAAN,CAAe,UAACC,OAAD,EAAa;AAC1B,UAAIA,OAAO,CAACC,MAAZ,EAAoB;AAClBD,QAAAA,OAAO,CAAClB,UAAR,GAAqB,IAArB;AACAkB,QAAAA,OAAO,CAACE,aAAR,GAAwB,IAAxB;;AAEA,YAAIF,OAAO,CAACG,QAAR,CAAiBC,GAArB,EAA0B;AACxBJ,UAAAA,OAAO,CAACG,QAAR,CAAiBC,GAAjB,CAAqBC,UAArB,GAAkC,EAAlC;AACD;AACF;AACF,KATD;AAUA,QAAIC,GAAG,GAAG,IAAI/C,GAAJ,CAAQ5B,KAAR,CAAV;AACA,QAAI4E,UAAU,GAAG,IAAIC,kBAAJ,CAAuBF,GAAvB,CAAjB;AACAhG,IAAAA,KAAK,CAACmG,aAAN,CAAoBH,GAApB;AACD,GAhBD;AAiBD;;AAED,SAASvE,cAAT,GAA0B;AACxB,MAAIxB,QAAQ,GAAG,IAAIuB,QAAJ,CAAakC,YAAb,EAA2BG,aAA3B,CAAf;AACA5D,EAAAA,QAAQ,CAACmG,4BAAT,CAAsC,CAAtC;AACA,SAAOnG,QAAP;AACD;;AAED,SAASY,WAAT,GAAuB;AACrB,MAAIb,KAAK,GAAG,IAAIS,KAAJ,CAAUiD,YAAV,EAAwBG,aAAxB,CAAZ;AACAe,EAAAA,eAAe,CAAC5E,KAAD,CAAf;AACA+D,EAAAA,gBAAgB,CAAC/D,KAAD,CAAhB;AACAqF,EAAAA,eAAe,CAACrF,KAAD,CAAf;AACA,SAAOA,KAAP;AACD;;IAEKkG,kB;;;AACJ,8BAAYF,GAAZ,EAAiB;AAAA;;AAAA;;AACf,SAAKK,gBAAL,GAAwB,GAAxB;AACA,SAAKL,GAAL,GAAWA,GAAX;AACA,QAAIM,CAAC,GAAG,IAAIC,oBAAJ,CAAyB,UAACC,GAAD,EAAMC,KAAN;AAAA,aAC/B,MAAI,CAACC,cAAL,CAAoBF,GAApB,EAAyBC,KAAzB,CAD+B;AAAA,KAAzB,CAAR;AAGA,QAAIE,CAAC,GAAG,IAAIC,iBAAJ,CAAsB,UAACxD,CAAD,EAAIC,CAAJ;AAAA,aAAU,MAAI,CAACwD,mBAAL,CAAyBzD,CAAzB,EAA4BC,CAA5B,CAAV;AAAA,KAAtB,CAAR;AACD;;;;wCAEmBD,C,EAAGC,C,EAAG;AACxB,WAAK2C,GAAL,CAASzC,KAAT,CAAeD,CAAf,IAAoBF,CAAC,GAAG,KAAKiD,gBAA7B;AACD;;;6BAEQI,K,EAAO;AACd,UAAIA,KAAK,IAAIK,QAAQ,CAACC,IAAtB,EAA4B;AAC1B,aAAKf,GAAL,CAAS7C,SAAT,CAAmBC,CAAnB,GAAuB,CAAC,CAAxB;AACD,OAFD,MAEO,IAAI,KAAK4C,GAAL,CAAS7C,SAAT,CAAmBC,CAAnB,IAAwB,CAAC,CAA7B,EAAgC;AACrC,aAAK4C,GAAL,CAAS7C,SAAT,CAAmBC,CAAnB,GAAuB,CAAvB;AACD;AACF;;;8BAESqD,K,EAAO;AACf,UAAIA,KAAK,IAAIK,QAAQ,CAACC,IAAtB,EAA4B;AAC1B,aAAKf,GAAL,CAAS7C,SAAT,CAAmBC,CAAnB,GAAuB,CAAvB;AACD,OAFD,MAEO,IAAI,KAAK4C,GAAL,CAAS7C,SAAT,CAAmBC,CAAnB,IAAwB,CAA5B,EAA+B;AACpC,aAAK4C,GAAL,CAAS7C,SAAT,CAAmBC,CAAnB,GAAuB,CAAvB;AACD;AACF;;;6BAEQqD,K,EAAO;AACd,UAAIA,KAAK,IAAIK,QAAQ,CAACC,IAAtB,EAA4B;AAC1B,aAAKf,GAAL,CAAS7C,SAAT,CAAmBE,CAAnB,GAAuB,CAAvB;AACD,OAFD,MAEO,IAAI,KAAK2C,GAAL,CAAS7C,SAAT,CAAmBE,CAAnB,IAAwB,CAA5B,EAA+B;AACpC,aAAK2C,GAAL,CAAS7C,SAAT,CAAmBE,CAAnB,GAAuB,CAAvB;AACD;AACF;;;2BAEMoD,K,EAAO;AACZ,UAAIA,KAAK,IAAIK,QAAQ,CAACC,IAAtB,EAA4B;AAC1B,aAAKf,GAAL,CAAS7C,SAAT,CAAmBE,CAAnB,GAAuB,CAAC,CAAxB;AACD,OAFD,MAEO,IAAI,KAAK2C,GAAL,CAAS7C,SAAT,CAAmBE,CAAnB,IAAwB,CAAC,CAA7B,EAAgC;AACrC,aAAK2C,GAAL,CAAS7C,SAAT,CAAmBE,CAAnB,GAAuB,CAAvB;AACD;AACF;;;mCAEcmD,G,EAAKC,K,EAAO;AACzB,UAAID,GAAG,IAAIQ,IAAI,CAACC,IAAhB,EAAsB;AACpB,aAAKC,QAAL,CAAcT,KAAd;AACD;;AACD,UAAID,GAAG,IAAIQ,IAAI,CAACD,IAAhB,EAAsB;AACpB,aAAKI,QAAL,CAAcV,KAAd;AACD;;AACD,UAAID,GAAG,IAAIQ,IAAI,CAACI,KAAhB,EAAuB;AACrB,aAAKC,SAAL,CAAeZ,KAAf;AACD;;AACD,UAAID,GAAG,IAAIQ,IAAI,CAACM,EAAhB,EAAoB;AAClB,aAAKC,MAAL,CAAYd,KAAZ;AACD;AACF;;;;;;IAGGG,iB;;;AACJ,6BAAYY,QAAZ,EAAsB;AAAA;;AACpB,SAAKA,QAAL,GAAgBA,QAAhB;AACA,SAAKC,sBAAL;AACA,SAAKC,WAAL;AACD;;;;6CAEwB;AACvB,UAAIC,IAAI,GAAG,IAAX;;AACAzF,MAAAA,QAAQ,CAAC0F,WAAT,GAAuB,UAAUC,UAAV,EAAsB;AAC3CF,QAAAA,IAAI,CAACH,QAAL,CAAcK,UAAU,CAACC,SAAzB,EAAoCD,UAAU,CAACE,SAA/C;AACD,OAFD;AAGD;;;kCAEa;AACZ7F,MAAAA,QAAQ,CAAC8F,WAAT,GAAuB,YAAY;AACjC9F,QAAAA,QAAQ,CAACC,IAAT,CAAc8F,kBAAd;AACD,OAFD;AAGD;;;;;;AAGH,IAAMjB,IAAI,GAAG;AACXC,EAAAA,IAAI,EAAE,GADK;AAEXG,EAAAA,KAAK,EAAE,GAFI;AAGXE,EAAAA,EAAE,EAAE,GAHO;AAIXP,EAAAA,IAAI,EAAE;AAJK,CAAb;AAOA,IAAMD,QAAQ,GAAG;AACfQ,EAAAA,EAAE,EAAE,CADW;AAEfP,EAAAA,IAAI,EAAE;AAFS,CAAjB;;IAKMR,oB;;;AACJ,gCAAYiB,QAAZ,EAAsB;AAAA;;AACpB,SAAKU,OAAL,GAAeV,QAAf;AACA,SAAKW,kBAAL;AACA,SAAKC,oBAAL;AACD;;;;yCAEoB;AACnB,UAAIT,IAAI,GAAG,IAAX;;AACAzF,MAAAA,QAAQ,CAACmG,OAAT,GAAmB,UAAUC,QAAV,EAAoB;AACrCX,QAAAA,IAAI,CAACO,OAAL,CAAaI,QAAQ,CAAC9B,GAAtB,EAA2BM,QAAQ,CAACQ,EAApC;AACD,OAFD;AAGD;;;2CAEsB;AACrB,UAAIK,IAAI,GAAG,IAAX;;AACAzF,MAAAA,QAAQ,CAACqG,SAAT,GAAqB,UAAUD,QAAV,EAAoB;AACvCX,QAAAA,IAAI,CAACO,OAAL,CAAaI,QAAQ,CAAC9B,GAAtB,EAA2BM,QAAQ,CAACC,IAApC;AACD,OAFD;AAGD;;;;;;AAGH,SAASyB,IAAT,GAAgB;AACd,MAAIvI,QAAQ,GAAGwB,cAAc,EAA7B;AACA,MAAIzB,KAAK,GAAGa,WAAW,EAAvB;AACA,MAAIX,MAAM,GAAG2E,YAAY,EAAzB;AAEAK,EAAAA,kBAAkB,CAAChF,MAAD,EAASD,QAAT,CAAlB;AAEA,MAAIwI,MAAM,GAAG,IAAI1I,UAAJ,CAAeC,KAAf,EAAsBC,QAAtB,EAAgCC,MAAhC,CAAb;AACAuI,EAAAA,MAAM,CAACC,GAAP;AACD;;AAEDF,IAAI","sourcesContent":["class GameEngine {\r\n  constructor(scene, renderer, camera) {\r\n    this.scene = scene;\r\n    this.renderer = renderer;\r\n    this.camera = camera;\r\n  }\r\n\r\n  run() {\r\n    this.runGameLoop();\r\n  }\r\n\r\n  runGameLoop() {\r\n    this.updateGame();\r\n    this.updatePhysics();\r\n    this.render();\r\n    requestAnimationFrame(() => this.runGameLoop());\r\n  }\r\n\r\n  updateGame() {\r\n    this.scene.update();\r\n  }\r\n\r\n  updatePhysics() {}\r\n\r\n  render() {\r\n    this.renderer.render(this.scene.scene, this.camera);\r\n  }\r\n}\r\n\r\nclass Scene {\r\n  constructor(width, height) {\r\n    this.width = width;\r\n    this.height = height;\r\n    this.gameObjects = [];\r\n    this.createScene();\r\n  }\r\n\r\n  createScene() {\r\n    this.scene = new THREE.Scene();\r\n  }\r\n\r\n  addSkyBox(skybox) {\r\n    this.scene.background = skybox.cubeTexture;\r\n  }\r\n\r\n  addLight(light) {\r\n    this.scene.add(light);\r\n  }\r\n\r\n  addGameObject(gameObject) {\r\n    this.scene.add(gameObject.model);\r\n    this.gameObjects.push(gameObject);\r\n  }\r\n\r\n  update() {\r\n    this.gameObjects.forEach((gameObject) => {\r\n      gameObject.update();\r\n    });\r\n  }\r\n}\r\n\r\nclass Renderer {\r\n  constructor(width, height) {\r\n    this.createRenderer();\r\n    this.setupSize(width, height);\r\n    this.enableShadowMap();\r\n    this.addToDocument();\r\n  }\r\n\r\n  setupSize(width, height) {\r\n    this.renderer.setSize(width, height);\r\n  }\r\n\r\n  enableShadowMap() {\r\n    this.renderer.shadowMap.enabled = true;\r\n  }\r\n\r\n  createRenderer() {\r\n    this.renderer = new THREE.WebGLRenderer({ antialias: true });\r\n  }\r\n\r\n  addToDocument() {\r\n    document.body.appendChild(this.renderer.domElement);\r\n  }\r\n\r\n  setupToneMappingWithExposure(exposure) {\r\n    this.renderer.toneMapping = THREE.ReinhardToneMapping;\r\n    this.renderer.toneMappingExposure = exposure;\r\n  }\r\n\r\n  render(scene, camera) {\r\n    this.renderer.render(scene, camera);\r\n  }\r\n}\r\n\r\nclass Skybox {\r\n  constructor(path, images) {\r\n    this.cubeTexture = new THREE.CubeTextureLoader().setPath(path).load(images);\r\n  }\r\n}\r\n\r\nclass GameObject {\r\n  constructor(model) {\r\n    this.model = model;\r\n  }\r\n\r\n  update() {}\r\n}\r\n\r\nclass Car extends GameObject {\r\n  constructor(model) {\r\n    super(model);\r\n    this.speed = 1;\r\n    this.direction = { x: 0, y: 0, z: 0 };\r\n    this.angle = { z: 0 };\r\n  }\r\n\r\n  update() {\r\n    this.model.translateOnAxis(this.direction, this.speed);\r\n    this.model.rotation.z = this.angle.z;\r\n  }\r\n}\r\n\r\nconst windowsWidth = window.innerWidth;\r\nconst windowsHeight = window.innerHeight;\r\n\r\nfunction addSkyBoxToScene(scene) {\r\n  let path = \"images/skybox1/greenery/\";\r\n  let images = [\r\n    \"meadow_ft.jpg\",\r\n    \"meadow_bk.jpg\",\r\n    \"meadow_up.jpg\",\r\n    \"meadow_dn.jpg\",\r\n    \"meadow_rt.jpg\",\r\n    \"meadow_lf.jpg\",\r\n  ];\r\n  let skybox = new Skybox(path, images);\r\n  scene.addSkyBox(skybox);\r\n}\r\n\r\nfunction addHemiLight(scene) {\r\n  const hemiLight = new THREE.HemisphereLight(0xffff33, 0x5b573d, 2.5);\r\n  scene.addLight(hemiLight);\r\n}\r\n\r\nfunction addSpotLight(scene) {\r\n  const spotLight1 = new THREE.SpotLight(0xffffff, 3);\r\n  spotLight1.castShadow = true;\r\n  spotLight1.shadow.bias = -0.0001;\r\n  spotLight1.shadow.mapSize.width = 4096;\r\n  spotLight1.shadow.mapSize.height = 4096;\r\n  scene.addLight(spotLight1);\r\n}\r\n\r\nfunction addLightToScene(scene) {\r\n  addHemiLight(scene);\r\n  addSpotLight(scene);\r\n}\r\n\r\nfunction createCamera() {\r\n  const aspect = windowsWidth / windowsHeight;\r\n  let camera = new THREE.PerspectiveCamera(90, aspect, 0.1, 40000);\r\n  camera.position.set(4, 4, 20);\r\n\r\n  return camera;\r\n}\r\n\r\nfunction setupCameraControl(camera, renderer) {\r\n  let control = new THREE.OrbitControls(camera, renderer.renderer.domElement);\r\n  control.update();\r\n}\r\n\r\nfunction addModelToScene(scene) {\r\n  new THREE.GLTFLoader().load(\"models/house/scene.gltf\", (result) => {\r\n    let model = result.scene.children[0];\r\n    model.position.set(0.0, 0.0, 0.0);\r\n    model.traverse((object1) => {\r\n      if (object1.isMesh) {\r\n        object1.castShadow = true;\r\n        object1.receiveShadow = true;\r\n\r\n        if (object1.material.map) {\r\n          object1.material.map.anisotropy = 16;\r\n        }\r\n      }\r\n    });\r\n    let car = new Car(model);\r\n    let controller = new CarInputController(car);\r\n    scene.addGameObject(car);\r\n  });\r\n}\r\n\r\nfunction createRenderer() {\r\n  let renderer = new Renderer(windowsWidth, windowsHeight);\r\n  renderer.setupToneMappingWithExposure(2);\r\n  return renderer;\r\n}\r\n\r\nfunction createScene() {\r\n  let scene = new Scene(windowsWidth, windowsHeight);\r\n  addLightToScene(scene);\r\n  addSkyBoxToScene(scene);\r\n  addModelToScene(scene);\r\n  return scene;\r\n}\r\n\r\nclass CarInputController {\r\n  constructor(car) {\r\n    this.mouseSensitivity = 200;\r\n    this.car = car;\r\n    let k = new KeyboardInputHandler((key, state) =>\r\n      this.listenKeyEvent(key, state)\r\n    );\r\n    let m = new MouseInputHandler((x, y) => this.listenMouseMovement(x, y));\r\n  }\r\n\r\n  listenMouseMovement(x, y) {\r\n    this.car.angle.z += x / this.mouseSensitivity;\r\n  }\r\n\r\n  moveLeft(state) {\r\n    if (state == KeyState.DOWN) {\r\n      this.car.direction.x = -1;\r\n    } else if (this.car.direction.x == -1) {\r\n      this.car.direction.x = 0;\r\n    }\r\n  }\r\n\r\n  moveRight(state) {\r\n    if (state == KeyState.DOWN) {\r\n      this.car.direction.x = 1;\r\n    } else if (this.car.direction.x == 1) {\r\n      this.car.direction.x = 0;\r\n    }\r\n  }\r\n\r\n  moveDown(state) {\r\n    if (state == KeyState.DOWN) {\r\n      this.car.direction.y = 1;\r\n    } else if (this.car.direction.y == 1) {\r\n      this.car.direction.y = 0;\r\n    }\r\n  }\r\n\r\n  moveUp(state) {\r\n    if (state == KeyState.DOWN) {\r\n      this.car.direction.y = -1;\r\n    } else if (this.car.direction.y == -1) {\r\n      this.car.direction.y = 0;\r\n    }\r\n  }\r\n\r\n  listenKeyEvent(key, state) {\r\n    if (key == Keys.LEFT) {\r\n      this.moveLeft(state);\r\n    }\r\n    if (key == Keys.DOWN) {\r\n      this.moveDown(state);\r\n    }\r\n    if (key == Keys.RIGHT) {\r\n      this.moveRight(state);\r\n    }\r\n    if (key == Keys.UP) {\r\n      this.moveUp(state);\r\n    }\r\n  }\r\n}\r\n\r\nclass MouseInputHandler {\r\n  constructor(listener) {\r\n    this.listener = listener;\r\n    this.setupMouseMoveListener();\r\n    this.lockPointer();\r\n  }\r\n\r\n  setupMouseMoveListener() {\r\n    let self = this;\r\n    document.onmousemove = function (mouseEvent) {\r\n      self.listener(mouseEvent.movementX, mouseEvent.movementY);\r\n    };\r\n  }\r\n\r\n  lockPointer() {\r\n    document.onmousedown = function () {\r\n      document.body.requestPointerLock();\r\n    };\r\n  }\r\n}\r\n\r\nconst Keys = {\r\n  LEFT: \"a\",\r\n  RIGHT: \"d\",\r\n  UP: \"w\",\r\n  DOWN: \"s\",\r\n};\r\n\r\nconst KeyState = {\r\n  UP: 0,\r\n  DOWN: 1,\r\n};\r\n\r\nclass KeyboardInputHandler {\r\n  constructor(listener) {\r\n    this.listner = listener;\r\n    this.setupKeyUpListener();\r\n    this.setupKeyDownListener();\r\n  }\r\n\r\n  setupKeyUpListener() {\r\n    let self = this;\r\n    document.onkeyup = function (keyEvent) {\r\n      self.listner(keyEvent.key, KeyState.UP);\r\n    };\r\n  }\r\n\r\n  setupKeyDownListener() {\r\n    let self = this;\r\n    document.onkeydown = function (keyEvent) {\r\n      self.listner(keyEvent.key, KeyState.DOWN);\r\n    };\r\n  }\r\n}\r\n\r\nfunction main() {\r\n  let renderer = createRenderer();\r\n  let scene = createScene();\r\n  let camera = createCamera();\r\n\r\n  setupCameraControl(camera, renderer);\r\n\r\n  let engine = new GameEngine(scene, renderer, camera);\r\n  engine.run();\r\n}\r\n\r\nmain();\r\n"],"file":"client.dev.js"}